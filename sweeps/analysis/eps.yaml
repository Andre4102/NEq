program: main.py
name: zero grad eps sweep
command:
  - ${env}
  - python3
  - ${program}
  - ${args}
method: grid
parameters:
  seed:
    values: [ 1 ]
  root:
    values: [ "/data/classification" ]
  amp:
    values: [ 1 ]
  device:
    values: [ "cuda" ]

  arch:
    values: [ "resnet32-cifar" ]

  epochs:
    values: [ 250 ]

  optim:
    values: [ "sgd" ]
  lr:
    values: [ 0.1 ]
  momentum:
    values: [ 0.9 ]
  weight-decay:
    values: [ 5e-4 ]

  rollback:
    values: [ "optim" ]
  topk:
    values: [ "0" ]
  random-mask:
    values: [ 0 ]
  mask-mode:
    values: [ "per-feature" ]
  delta-mode:
    values: [ "cosine" ]
  reduction:
    values: [ "mean" ]
  warmup:
    values: [ 1 ]
  eps:
    values: [ 5e-1, 2e-1, 1e-1, 5e-2, 2e-2, 1e-2, 5e-3, 2e-3, 1e-3 ]
  binomial:
    values: [ 0 ]